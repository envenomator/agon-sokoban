Zilog eZ80 Macro Assembler Version 4.3 (19073001) RELISTED15-Apr-23     15:21:42     page:   1


PC     Object              I  Line    Source 
                           A     1    ; Zilog eZ80 ANSI C Compiler Release 3.4
                           A     2    ; -nomodsect -optsize -noreduceopt -nopadbranch
                           A     3    ; -peephole -globalopt -localcse -const=ROM 
                           A     4    	FILE	"..\main.c"
                           A     5    	.assume ADL=1
                           A     6    .DEBUG "C"
                           A     7    	SEGMENT CODE
                           A     8    .BEGREC "fmt_type",19
                           A     9    .DEFINE "status"
                           A    10    .VALUE 0
                           A    11    .CLASS 8
                           A    12    .TYPE 12
                           A    13    .ENDEF
                           A    14    .DEFINE "flags"
                           A    15    .VALUE 1
                           A    16    .CLASS 8
                           A    17    .TYPE 12
                           A    18    .ENDEF
                           A    19    .DEFINE "size"
                           A    20    .VALUE 2
                           A    21    .CLASS 8
                           A    22    .TYPE 2
                           A    23    .ENDEF
                           A    24    .DEFINE "chr"
                           A    25    .VALUE 3
                           A    26    .CLASS 8
                           A    27    .TYPE 2
                           A    28    .ENDEF
                           A    29    .DEFINE "type"
                           A    30    .VALUE 4
                           A    31    .CLASS 8
                           A    32    .TYPE 2
                           A    33    .ENDEF
                           A    34    .DEFINE "field_width"
                           A    35    .VALUE 5
                           A    36    .CLASS 8
                           A    37    .TYPE 2
                           A    38    .ENDEF
                           A    39    .DEFINE "precision"
                           A    40    .VALUE 6
                           A    41    .CLASS 8
                           A    42    .TYPE 2
                           A    43    .ENDEF
                           A    44    .DEFINE "set_begin"
                           A    45    .VALUE 7
                           A    46    .CLASS 8
                           A    47    .TYPE 34
                           A    48    .ENDEF
                           A    49    .DEFINE "set_end"
                           A    50    .VALUE 10
                           A    51    .CLASS 8
                           A    52    .TYPE 34
                           A    53    .ENDEF
                           A    54    .DEFINE "pad_whole"
                           A    55    .VALUE 13
                           A    56    .CLASS 8
                           A    57    .TYPE 12
                           A    58    .ENDEF
                           A    59    .DEFINE "pad_pre_fract"
                           A    60    .VALUE 14
                           A    61    .CLASS 8
                           A    62    .TYPE 12
                           A    63    .ENDEF
                           A    64    .DEFINE "pad_post_fract"
                           A    65    .VALUE 15
                           A    66    .CLASS 8
                           A    67    .TYPE 12
                           A    68    .ENDEF
                           A    69    .DEFINE "pad_at"
                           A    70    .VALUE 16
                           A    71    .CLASS 8
                           A    72    .TYPE 34
                           A    73    .ENDEF
                           A    74    .ENDREC "fmt_type"
                           A    75    .BEGREC "flt_info",12
                           A    76    .DEFINE "flags"
                           A    77    .VALUE 0
                           A    78    .CLASS 8
                           A    79    .TYPE 12
                           A    80    .ENDEF
                           A    81    .DEFINE "exp"
                           A    82    .VALUE 1
                           A    83    .CLASS 8
                           A    84    .TYPE 2
                           A    85    .ENDEF
                           A    86    .DEFINE "digits"
                           A    87    .VALUE 2
                           A    88    .CLASS 8
                           A    89    .DIM 10
                           A    90    .TYPE 108
                           A    91    .ENDEF
                           A    92    .ENDREC "flt_info"
                           A    93    .BEGREC "NONAME0",8
                           A    94    .DEFINE "baudRate"
                           A    95    .VALUE 0
                           A    96    .CLASS 8
                           A    97    .TYPE 4
                           A    98    .ENDEF
                           A    99    .DEFINE "dataBits"
                           A   100    .VALUE 3
                           A   101    .CLASS 8
                           A   102    .TYPE 12
                           A   103    .ENDEF
                           A   104    .DEFINE "stopBits"
                           A   105    .VALUE 4
                           A   106    .CLASS 8
                           A   107    .TYPE 12
                           A   108    .ENDEF
                           A   109    .DEFINE "parity"
                           A   110    .VALUE 5
                           A   111    .CLASS 8
                           A   112    .TYPE 12
                           A   113    .ENDEF
                           A   114    .DEFINE "flowcontrol"
                           A   115    .VALUE 6
                           A   116    .CLASS 8
                           A   117    .TYPE 12
                           A   118    .ENDEF
                           A   119    .DEFINE "eir"
                           A   120    .VALUE 7
                           A   121    .CLASS 8
                           A   122    .TYPE 12
                           A   123    .ENDEF
                           A   124    .ENDREC "NONAME0"
                           A   125    .BEGREC "sokobanlevel",1207
                           A   126    .DEFINE "xpos"
                           A   127    .VALUE 0
                           A   128    .CLASS 8
                           A   129    .TYPE 12
                           A   130    .ENDEF
                           A   131    .DEFINE "ypos"
                           A   132    .VALUE 1
                           A   133    .CLASS 8
                           A   134    .TYPE 12
                           A   135    .ENDEF
                           A   136    .DEFINE "width"
                           A   137    .VALUE 2
                           A   138    .CLASS 8
                           A   139    .TYPE 12
                           A   140    .ENDEF
                           A   141    .DEFINE "height"
                           A   142    .VALUE 3
                           A   143    .CLASS 8
                           A   144    .TYPE 12
                           A   145    .ENDEF
                           A   146    .DEFINE "goals"
                           A   147    .VALUE 4
                           A   148    .CLASS 8
                           A   149    .TYPE 12
                           A   150    .ENDEF
                           A   151    .DEFINE "goalstaken"
                           A   152    .VALUE 5
                           A   153    .CLASS 8
                           A   154    .TYPE 12
                           A   155    .ENDEF
                           A   156    .DEFINE "crates"
                           A   157    .VALUE 6
                           A   158    .CLASS 8
                           A   159    .TYPE 12
                           A   160    .ENDEF
                           A   161    .DEFINE "data"
                           A   162    .VALUE 7
                           A   163    .CLASS 8
                           A   164    .DIM 30
                           A   165    .DIM 40
                           A   166    .TYPE 876
                           A   167    .ENDEF
                           A   168    .ENDREC "sokobanlevel"
                           A   169    .BEGREC "NONAME1",2
                           A   170    .DEFINE "ch"
                           A   171    .VALUE 0
                           A   172    .CLASS 8
                           A   173    .TYPE 2
                           A   174    .ENDEF
                           A   175    .DEFINE "tile_id"
                           A   176    .VALUE 1
                           A   177    .CLASS 8
                           A   178    .TYPE 12
                           A   179    .ENDEF
                           A   180    .ENDREC "NONAME1"
                           A   181    .BEGREC "undoitem",2
                           A   182    .DEFINE "movekey"
                           A   183    .VALUE 0
                           A   184    .CLASS 8
                           A   185    .TYPE 12
                           A   186    .ENDEF
                           A   187    .DEFINE "pushed"
                           A   188    .VALUE 1
                           A   189    .CLASS 8
                           A   190    .TYPE 12
                           A   191    .ENDEF
                           A   192    .ENDREC "undoitem"
                           A   193    ;    1	#include <stdio.h>
                           A   194    ;    2	#include <ctype.h>
                           A   195    ;    3	#include "mos-interface.h"
                           A   196    ;    4	#include "vdp.h"
                           A   197    ;    5	#include "game.h"
                           A   198    ;    6	#include "agontimer.h"
                           A   199    ;    7	
                           A   200    ;    8	#define FILE_LEVELS	"levels.bin"
                           A   201    ;    9	
                           A   202    ;   10	int main(int argc, char * argv[]) {
0400E5                     A   203    _main:
                           A   204    .DEFINE "_main"
                           A   205    
                           A   206    .VALUE _main
                           A   207    
                           A   208    .CLASS 2
                           A   209    
                           A   210    .TYPE 68
                           A   211    
                           A   212    .ENDEF
                           A   213    
                           A   214    .BEGFUNC "main",10,"_main"
                           A   215    
                           A   216    .LINE 10
                           A   217    
                           A   218    .DEFINE "argc"
                           A   219    
                           A   220    .CLASS 65
                           A   221    
                           A   222    .VALUE 6
                           A   223    
                           A   224    .TYPE 4
                           A   225    
                           A   226    .ENDEF
                           A   227    
                           A   228    .DEFINE "argv"
                           A   229    
                           A   230    .CLASS 65
                           A   231    
                           A   232    .VALUE 9
                           A   233    
                           A   234    .TYPE 290
                           A   235    
                           A   236    .ENDEF
                           A   237    
                           A   238    .DEFINE "levelnumber"
                           A   239    
                           A   240    .CLASS 65
                           A   241    
                           A   242    .VALUE -2
                           A   243    
                           A   244    .TYPE 3
                           A   245    
                           A   246    .ENDEF
                           A   247    
                           A   248    .DEFINE "ingame"
                           A   249    
                           A   250    .CLASS 65
                           A   251    
                           A   252    .VALUE -3
                           A   253    
                           A   254    .TYPE 12
                           A   255    
                           A   256    .ENDEF
                           A   257    
                           A   258    .DEFINE "levels"
                           A   259    
                           A   260    .CLASS 65
                           A   261    
                           A   262    .VALUE -4
                           A   263    
                           A   264    .TYPE 12
                           A   265    
                           A   266    .ENDEF
                           A   267    
                           A   268    .DEFINE "key"
                           A   269    
                           A   270    .CLASS 65
                           A   271    
                           A   272    .VALUE -5
                           A   273    
                           A   274    .TYPE 2
                           A   275    
                           A   276    .ENDEF
                           A   277    
0400E5 DDE5                A   278    	PUSH	IX
0400E7 DD210000 00         A   279    	LD	IX,0
0400EC DD39                A   280    	ADD	IX,SP
0400EE C5                  A   281    	PUSH	BC
0400EF C5                  A   282    	PUSH	BC
0400F0 3B                  A   283    	DEC	SP
0400F1 3B                  A   284    	DEC	SP
                           A   285    ;   11		UINT8 levels;
                           A   286    ;   12		INT16 levelnumber = 0;
                           A   287    .LINE 12
                           A   288    
0400F2 DD36FE00            A   289    	LD	(IX+%FFFFFFFE),%0
0400F6 DD36FF00            A   290    	LD	(IX+%FFFFFFFF),%0
                           A   291    ;   13		BOOL quit;
                           A   292    ;   14		BOOL ingame;
                           A   293    ;   15		char key;
                           A   294    ;   16		
                           A   295    ;   17		game_splash_screen();
                           A   296    .LINE 17
                           A   297    
0400FA CD 04 1E 04         A   298    	CALL	_game_splash_screen
                           A   299    ;   18	
                           A   300    ;   19		levels = game_readLevels(FILE_LEVEL
                           A   301    .LINE 19
                           A   302    
0400FE 01 5B 51 04         A   303    	LD	BC,L__0
040102 C5                  A   304    	PUSH	BC
040103 CD F1 26 04         A   305    	CALL	_game_readLevels
040107 C1                  A   306    	POP	BC
040108 DD77FC              A   307    	LD	(IX+%FFFFFFFC),A
                           A   308    ;   20		
                           A   309    ;   21		if(levels)	{	
                           A   310    .LINE 21
                           A   311    
04010B B7                  A   312    	OR	A,A
04010C CA 98 02 04         A   313    	JR	Z,L_23
                           A   314    ;   22			vdp_mode(VDPMODE_640x480_16C);
                           A   315    .LINE 22
                           A   316    
040110 01030000            A   317    	LD	BC,3
040114 C5                  A   318    	PUSH	BC
040115 CD 98 03 04         A   319    	CALL	_vdp_mode
040119 C1                  A   320    	POP	BC
                           A   321    ;   23			delayms(1000);
                           A   322    .LINE 23
                           A   323    
04011A 01E80300            A   324    	LD	BC,1000
04011E C5                  A   325    	PUSH	BC
04011F CD 79 2D 04         A   326    	CALL	_delayms
040123 C1                  A   327    	POP	BC
                           A   328    ;   24			vdp_cursorDisable();
                           A   329    .LINE 24
                           A   330    
040124 CD 84 0D 04         A   331    	CALL	_vdp_cursorDisable
                           A   332    ;   25	
                           A   333    ;   26			game_sendSpriteData();		
                           A   334    .LINE 26
                           A   335    
040128 CD 5D 0F 04         A   336    	CALL	_game_sendSpriteData
                           A   337    ;   27			while(levelnumber >= 0) {
                           A   338    .LINE 27
                           A   339    
04012C C3 8B 02 04         A   340    	JR	L_20
040130                     A   341    L_21:
                           A   342    ;   28				levelnumber = game_selectLe
                           A   343    .LINE 28
                           A   344    
040130 DD07FE              A   345    	LD	BC,(IX+%FFFFFFFE)
040133 C5                  A   346    	PUSH	BC
040134 DD4EFC              A   347    	LD	C,(IX+%FFFFFFFC)
040137 0600                A   348    	LD	B,%0
040139 C5                  A   349    	PUSH	BC
04013A CD 85 21 04         A   350    	CALL	_game_selectLevel
04013E C1                  A   351    	POP	BC
04013F C1                  A   352    	POP	BC
040140 DD75FE              A   353    	LD	(IX+%FFFFFFFE),L
040143 DD74FF              A   354    	LD	(IX+%FFFFFFFF),H
                           A   355    ;   29				if(levelnumber >= 0)
                           A   356    .LINE 29
                           A   357    
040146 DD27FE              A   358    	LD	HL,(IX+%FFFFFFFE)
040149 CD 49 37 04         A   359    	CALL	__scmpzero
04014D FA 8B 02 04         A   360    	JP	M,L_20
                           A   361    ;   30				{
                           A   362    ;   31					// Start game
                           A   363    ;   32					ingame = TRUE;
                           A   364    .LINE 32
                           A   365    
040151 DD36FD01            A   366    	LD	(IX+%FFFFFFFD),%1
                           A   367    ;   33					vdp_cls();
                           A   368    .LINE 33
                           A   369    
040155 CD 42 04 04         A   370    	CALL	_vdp_cls
                           A   371    ;   34					game_initLevel(levelnum
                           A   372    .LINE 34
                           A   373    
040159 DD4EFE              A   374    	LD	C,(IX+%FFFFFFFE)
04015C 0600                A   375    	LD	B,%0
04015E C5                  A   376    	PUSH	BC
04015F CD DF 27 04         A   377    	CALL	_game_initLevel
040163 C1                  A   378    	POP	BC
                           A   379    ;   35					game_initSprites();		
                           A   380    .LINE 35
                           A   381    
040164 CD 35 28 04         A   382    	CALL	_game_initSprites
                           A   383    ;   36					game_displayLevel();
                           A   384    .LINE 36
                           A   385    
040168 CD 5D 23 04         A   386    	CALL	_game_displayLevel
                           A   387    ;   37					while(ingame) {
                           A   388    .LINE 37
                           A   389    
04016C C3 83 02 04         A   390    	JR	L_17
040170                     A   391    L_18:
                           A   392    ;   38						key = getch();
                           A   393    .LINE 38
                           A   394    
040170 CD 90 29 04         A   395    	CALL	_getch
040174 DD77FB              A   396    	LD	(IX+%FFFFFFFB),A
                           A   397    ;   39						switch(key) {
                           A   398    .LINE 39
                           A   399    
040177 17ED62              A   400    	SEXT	HL
04017A DD6EFB              A   401    	LD	L,(IX+%FFFFFFFB)
04017D CD F0 36 04         A   402    	CALL	__case8D
040181 E9                  A   403    	JP	(HL)
040182                     A   404    L__3:
040182 0500                A   405    	DW	5
040184 1B                  A   406    	DB	27
040185 9B0104              A   407    	DW24	L_2	
                           A   408    
040188 51                  A   409    	DB	81
040189 9B0104              A   410    	DW24	L_1	
                           A   411    
04018C 68                  A   412    	DB	104
04018D DD0104              A   413    	DW24	L_5	
                           A   414    
040190 71                  A   415    	DB	113
040191 9B0104              A   416    	DW24	L_0	
                           A   417    
040194 75                  A   418    	DB	117
040195 070204              A   419    	DW24	L_6	
                           A   420    
040198 0D0204              A   421    	DW24	L_7	
                           A   422    
                           A   423    ;   40							case 'q':
04019B                     A   424    L_0:
                           A   425    .LINE 40
                           A   426    
                           A   427    ;   41							case 'Q':
04019B                     A   428    L_1:
                           A   429    .LINE 41
                           A   430    
                           A   431    ;   42							case 27:
04019B                     A   432    L_2:
                           A   433    .LINE 42
                           A   434    
                           A   435    ;   43								game_resetS
                           A   436    .LINE 43
                           A   437    
04019B CD E1 10 04         A   438    	CALL	_game_resetSprites
                           A   439    ;   44								ingame = (g
                           A   440    .LINE 44
                           A   441    
04019F 016E0000            A   442    	LD	BC,110
0401A3 C5                  A   443    	PUSH	BC
0401A4 01790000            A   444    	LD	BC,121
0401A8 C5                  A   445    	PUSH	BC
0401A9 01 66 51 04         A   446    	LD	BC,L__4
0401AD C5                  A   447    	PUSH	BC
0401AE CD 0D 1D 04         A   448    	CALL	_game_getResponse
0401B2 C1                  A   449    	POP	BC
0401B3 C1                  A   450    	POP	BC
0401B4 C1                  A   451    	POP	BC
0401B5 47                  A   452    	LD	B,A
0401B6 78                  A   453    	LD	A,B
0401B7 17ED62              A   454    	SEXT	HL
0401BA 68                  A   455    	LD	L,B
0401BB 01790000            A   456    	LD	BC,121
0401BF B7                  A   457    	OR	A,A
0401C0 ED42                A   458    	SBC	HL,BC
0401C2 28 04               A   459    	JR	Z,L__6
0401C4 3E01                A   460    	LD	A,%1
0401C6 18 01               A   461    	JR	L__7
0401C8                     A   462    L__6:
0401C8 AF                  A   463    	XOR	A,A
0401C9                     A   464    L__7:
0401C9 DD77FD              A   465    	LD	(IX+%FFFFFFFD),A
                           A   466    ;   45								if(ingame) 
                           A   467    .LINE 45
                           A   468    
0401CC B7                  A   469    	OR	A,A
0401CD CA 83 02 04         A   470    	JR	Z,L_17
                           A   471    ;   46									game_in
                           A   472    .LINE 46
                           A   473    
0401D1 CD 35 28 04         A   474    	CALL	_game_initSprites
                           A   475    ;   47									game_di
                           A   476    .LINE 47
                           A   477    
0401D5 CD 5D 23 04         A   478    	CALL	_game_displayLevel
                           A   479    ;   48								}
                           A   480    .LINE 48
                           A   481    
                           A   482    ;   49								break;
                           A   483    .LINE 49
                           A   484    
0401D9 C3 83 02 04         A   485    	JR	L_17
                           A   486    ;   50							case 'h':
0401DD                     A   487    L_5:
                           A   488    .LINE 50
                           A   489    
                           A   490    ;   51								game_resetS
                           A   491    .LINE 51
                           A   492    
0401DD CD E1 10 04         A   493    	CALL	_game_resetSprites
                           A   494    ;   52								vdp_cls();
                           A   495    .LINE 52
                           A   496    
0401E1 CD 42 04 04         A   497    	CALL	_vdp_cls
                           A   498    ;   53								game_displa
                           A   499    .LINE 53
                           A   500    
0401E5 010D0000            A   501    	LD	BC,13
0401E9 C5                  A   502    	PUSH	BC
0401EA 011E0000            A   503    	LD	BC,30
0401EE C5                  A   504    	PUSH	BC
0401EF CD E8 1E 04         A   505    	CALL	_game_displayHelp
0401F3 C1                  A   506    	POP	BC
0401F4 C1                  A   507    	POP	BC
                           A   508    ;   54								getch();
                           A   509    .LINE 54
                           A   510    
0401F5 CD 90 29 04         A   511    	CALL	_getch
                           A   512    ;   55								vdp_cls();
                           A   513    .LINE 55
                           A   514    
0401F9 CD 42 04 04         A   515    	CALL	_vdp_cls
                           A   516    ;   56								game_initSp
                           A   517    .LINE 56
                           A   518    
0401FD CD 35 28 04         A   519    	CALL	_game_initSprites
                           A   520    ;   57								game_displa
                           A   521    .LINE 57
                           A   522    
040201 CD 5D 23 04         A   523    	CALL	_game_displayLevel
                           A   524    ;   58								break;
                           A   525    .LINE 58
                           A   526    
040205 18 7C               A   527    	JR	L_17
                           A   528    ;   59							case 'u':
040207                     A   529    L_6:
                           A   530    .LINE 59
                           A   531    
                           A   532    ;   60								game_handle
                           A   533    .LINE 60
                           A   534    
040207 CD 1A 19 04         A   535    	CALL	_game_handleUndoMove
                           A   536    ;   61								break;
                           A   537    .LINE 61
                           A   538    
04020B 18 76               A   539    	JR	L_17
                           A   540    ;   62							default:
04020D                     A   541    L_7:
                           A   542    .LINE 62
                           A   543    
                           A   544    ;   63								ingame = !g
                           A   545    .LINE 63
                           A   546    
04020D DD4EFB              A   547    	LD	C,(IX+%FFFFFFFB)
040210 0600                A   548    	LD	B,%0
040212 C5                  A   549    	PUSH	BC
040213 CD 9C 1A 04         A   550    	CALL	_game_handleKey
040217 C1                  A   551    	POP	BC
040218 B7                  A   552    	OR	A,A
040219 20 09               A   553    	JR	NZ,L_9
04021B 01010000            A   554    	LD	BC,1
04021F DD0FF8              A   555    	LD	(IX+%FFFFFFF8),BC
040222 18 07               A   556    	JR	L_10
040224                     A   557    L_9:
040224 01000000            A   558    	LD	BC,0
040228 DD0FF8              A   559    	LD	(IX+%FFFFFFF8),BC
04022B                     A   560    L_10:
04022B DD7EF8              A   561    	LD	A,(IX+%FFFFFFF8)
04022E DD77FD              A   562    	LD	(IX+%FFFFFFFD),A
                           A   563    ;   64								if(!ingame)
                           A   564    .LINE 64
                           A   565    
040231 B7                  A   566    	OR	A,A
040232 20 4F               A   567    	JR	NZ,L_17
                           A   568    ;   65								{
                           A   569    ;   66									levelnu
                           A   570    .LINE 66
                           A   571    
040234 DD27FE              A   572    	LD	HL,(IX+%FFFFFFFE)
040237 23                  A   573    	INC	HL
040238 DD75FE              A   574    	LD	(IX+%FFFFFFFE),L
04023B DD74FF              A   575    	LD	(IX+%FFFFFFFF),H
                           A   576    ;   67									if(leve
                           A   577    .LINE 67
                           A   578    
04023E DD07FE              A   579    	LD	BC,(IX+%FFFFFFFE)
040241 CD B0 37 04         A   580    	CALL	__stoi
040245 E5C1                A   581    	LD	BC,HL
040247 DD7EFC              A   582    	LD	A,(IX+%FFFFFFFC)
04024A B7ED62              A   583    	UEXT	HL
04024D 6F                  A   584    	LD	L,A
04024E E5D1                A   585    	LD	DE,HL
040250 C5E1                A   586    	LD	HL,BC
040252 B7                  A   587    	OR	A,A
040253 ED52                A   588    	SBC	HL,DE
040255 20 08               A   589    	JR	NZ,L_14
040257 DD36FE00            A   590    	LD	(IX+%FFFFFFFE),%0
04025B DD36FF00            A   591    	LD	(IX+%FFFFFFFF),%0
04025F                     A   592    L_14:
                           A   593    ;   68									delayms
                           A   594    .LINE 68
                           A   595    
04025F 01C80000            A   596    	LD	BC,200
040263 C5                  A   597    	PUSH	BC
040264 CD 79 2D 04         A   598    	CALL	_delayms
040268 C1                  A   599    	POP	BC
                           A   600    ;   69									game_re
                           A   601    .LINE 69
                           A   602    
040269 CD E1 10 04         A   603    	CALL	_game_resetSprites
                           A   604    ;   70									game_ge
                           A   605    .LINE 70
                           A   606    
04026D 011B0000            A   607    	LD	BC,27
040271 C5                  A   608    	PUSH	BC
040272 010D0000            A   609    	LD	BC,13
040276 C5                  A   610    	PUSH	BC
040277 01 7F 51 04         A   611    	LD	BC,L__12
04027B C5                  A   612    	PUSH	BC
04027C CD 0D 1D 04         A   613    	CALL	_game_getResponse
040280 C1                  A   614    	POP	BC
040281 C1                  A   615    	POP	BC
040282 C1                  A   616    	POP	BC
                           A   617    ;   71								}
                           A   618    ;   72							break;
                           A   619    ;   73						}					
                           A   620    ;   74					}
040283                     A   621    L_17:
                           A   622    .LINE 74
                           A   623    
040283 DD7EFD              A   624    	LD	A,(IX+%FFFFFFFD)
040286 B7                  A   625    	OR	A,A
040287 C2 70 01 04         A   626    	JR	NZ,L_18
                           A   627    ;   75				}
                           A   628    ;   76			}
04028B                     A   629    L_20:
                           A   630    .LINE 76
                           A   631    
04028B DD27FE              A   632    	LD	HL,(IX+%FFFFFFFE)
04028E CD 49 37 04         A   633    	CALL	__scmpzero
040292 F2 30 01 04         A   634    	JP	P,L_21
040296 18 36               A   635    	JR	L_24
                           A   636    ;   77		}
                           A   637    ;   78		else {
040298                     A   638    L_23:
                           A   639    .LINE 78
                           A   640    
                           A   641    ;   79			vdp_cursorGoto(15,38);
                           A   642    .LINE 79
                           A   643    
040298 01260000            A   644    	LD	BC,38
04029C C5                  A   645    	PUSH	BC
04029D 010F0000            A   646    	LD	BC,15
0402A1 C5                  A   647    	PUSH	BC
0402A2 CD 8A 04 04         A   648    	CALL	_vdp_cursorGoto
0402A6 C1                  A   649    	POP	BC
0402A7 C1                  A   650    	POP	BC
                           A   651    ;   80			vdp_fgcolour(BRIGHT_RED);
                           A   652    .LINE 80
                           A   653    
0402A8 01090000            A   654    	LD	BC,9
0402AC C5                  A   655    	PUSH	BC
0402AD CD BC 04 04         A   656    	CALL	_vdp_fgcolour
0402B1 C1                  A   657    	POP	BC
                           A   658    ;   81			puts("No level available! - pre
                           A   659    .LINE 81
                           A   660    
0402B2 01 8F 51 04         A   661    	LD	BC,L__15
0402B6 C5                  A   662    	PUSH	BC
0402B7 CD 77 35 04         A   663    	CALL	_puts
0402BB C1                  A   664    	POP	BC
                           A   665    ;   82			getch();
                           A   666    .LINE 82
                           A   667    
0402BC CD 90 29 04         A   668    	CALL	_getch
                           A   669    ;   83			vdp_cls();
                           A   670    .LINE 83
                           A   671    
0402C0 CD 42 04 04         A   672    	CALL	_vdp_cls
                           A   673    ;   84			vdp_fgcolour(BRIGHT_WHITE);
                           A   674    .LINE 84
                           A   675    
0402C4 010F0000            A   676    	LD	BC,15
0402C8 C5                  A   677    	PUSH	BC
0402C9 CD BC 04 04         A   678    	CALL	_vdp_fgcolour
0402CD C1                  A   679    	POP	BC
                           A   680    ;   85		}
0402CE                     A   681    L_24:
                           A   682    .LINE 85
                           A   683    
                           A   684    ;   86		vdp_mode(VDPMODE_DEFAULT);
                           A   685    .LINE 86
                           A   686    
0402CE 01010000            A   687    	LD	BC,1
0402D2 C5                  A   688    	PUSH	BC
0402D3 CD 98 03 04         A   689    	CALL	_vdp_mode
0402D7 C1                  A   690    	POP	BC
                           A   691    ;   87		puts("Thank you for playing Sokoban
                           A   692    .LINE 87
                           A   693    
0402D8 01 B3 51 04         A   694    	LD	BC,L__16
0402DC C5                  A   695    	PUSH	BC
0402DD CD 77 35 04         A   696    	CALL	_puts
0402E1 C1                  A   697    	POP	BC
                           A   698    ;   88		return 0;
                           A   699    .LINE 88
                           A   700    
0402E2 B7                  A   701    	OR	A,A
0402E3 ED62                A   702    	SBC	HL,HL
                           A   703    ;   89	}
                           A   704    .LINE 89
                           A   705    
0402E5 DDF9                A   706    	LD	SP,IX
0402E7 DDE1                A   707    	POP	IX
0402E9 C9                  A   708    	RET	
                           A   709    
                           A   710    
                           A   711    ;**************************** _main ***********
                           A   712    ;Name                         Addr/Register   S
                           A   713    ;_puts                               IMPORT  --
                           A   714    ;_vdp_fgcolour                       IMPORT  --
                           A   715    ;_vdp_cursorGoto                     IMPORT  --
                           A   716    ;_game_handleKey                     IMPORT  --
                           A   717    ;_game_handleUndoMove                IMPORT  --
                           A   718    ;_game_displayHelp                   IMPORT  --
                           A   719    ;_game_getResponse                   IMPORT  --
                           A   720    ;_game_resetSprites                  IMPORT  --
                           A   721    ;_getch                              IMPORT  --
                           A   722    ;_game_displayLevel                  IMPORT  --
                           A   723    ;_game_initSprites                   IMPORT  --
                           A   724    ;_game_initLevel                     IMPORT  --
                           A   725    ;_vdp_cls                            IMPORT  --
                           A   726    ;_game_selectLevel                   IMPORT  --
                           A   727    ;_game_sendSpriteData                IMPORT  --
                           A   728    ;_vdp_cursorDisable                  IMPORT  --
                           A   729    ;_delayms                            IMPORT  --
                           A   730    ;_vdp_mode                           IMPORT  --
                           A   731    ;_game_readLevels                    IMPORT  --
                           A   732    ;_game_splash_screen                 IMPORT  --
                           A   733    ;temp11                                IX-8    
                           A   734    ;key                                   IX-5    
                           A   735    ;levels                                IX-4    
                           A   736    ;ingame                                IX-3    
                           A   737    ;levelnumber                           IX-2    
                           A   738    ;argv                                  IX+9    
                           A   739    ;argc                                  IX+6    
                           A   740    
                           A   741    
                           A   742    ; Stack Frame Size: 20 (bytes)
                           A   743    ;       Spill Code: 0 (instruction)
                           A   744    
                           A   745    
                           A   746    .ENDFUNC "main",89,"_main"
                           A   747    	SEGMENT STRSECT
04515B                     A   748    L__0:
04515B 6C657665 6C732E62   A   749    	DB	"levels.bin"
045163 696E 
045165 00                  A   750    	DB	0
045166                     A   751    L__4:
045166 5265616C 6C792051   A   752    	DB	"Really QUIT level (y/n)?"
04516E 55495420 6C657665 
045176 6C202879 2F6E293F 
04517E 00                  A   753    	DB	0
04517F                     A   754    L__12:
04517F 4C657665 6C20636F   A   755    	DB	"Level complete!"
045187 6D706C65 746521 
04518E 00                  A   756    	DB	0
04518F                     A   757    L__15:
04518F 4E6F206C 6576656C   A   758    	DB	"No level available! - press any key"
045197 20617661 696C6162 
04519F 6C652120 2D207072 
0451A7 65737320 616E7920 
0451AF 6B6579 
0451B2 00                  A   759    	DB	0
0451B3                     A   760    L__16:
0451B3 5468616E 6B20796F   A   761    	DB	"Thank you for playing Sokoban"
0451BB 7520666F 7220706C 
0451C3 6179696E 6720536F 
0451CB 6B6F6261 6E 
0451D0 0D0A00              A   762    	DB	13,10,0
                           A   763    	XREF _delayms:ROM
                           A   764    	XREF _game_splash_screen:ROM
                           A   765    	XREF _game_handleUndoMove:ROM
                           A   766    	XREF _game_displayHelp:ROM
                           A   767    	XREF _game_getResponse:ROM
                           A   768    	XREF _game_selectLevel:ROM
                           A   769    	XREF _game_handleKey:ROM
                           A   770    	XREF _game_displayLevel:ROM
                           A   771    	XREF _game_resetSprites:ROM
                           A   772    	XREF _game_initSprites:ROM
                           A   773    	XREF _game_initLevel:ROM
                           A   774    	XREF _game_sendSpriteData:ROM
                           A   775    	XREF _game_readLevels:ROM
                           A   776    	XREF _vdp_fgcolour:ROM
                           A   777    	XREF _vdp_cursorDisable:ROM
                           A   778    	XREF _vdp_cursorGoto:ROM
                           A   779    	XREF _vdp_cls:ROM
                           A   780    	XREF _vdp_mode:ROM
                           A   781    	XREF _getch:ROM
                           A   782    	XREF _puts:ROM
                           A   783    	XREF __stoi:ROM
                           A   784    	XREF __scmpzero:ROM
                           A   785    	XREF __case8D:ROM
                           A   786    	XDEF _main
                           A   787    	END


Errors: 0
Warnings: 0
Lines Assembled: 788
